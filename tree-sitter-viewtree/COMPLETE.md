# ‚úÖ COMPLETE - Tree-sitter Grammar for view.tree

## üéØ –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é!

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è Tree-sitter –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ view.tree —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–π –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∏ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞.

---

## üìã –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ (`grammar.js`)

**–ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** Nested token chains
```javascript
token_chain: $ => seq(
  $._token,
  optional(seq(' ', $.token_chain))
)
```

–≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–æ–∫–µ–Ω–æ–≤, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é mol_tree2!

**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
- TAB-based –æ—Ç—Å—Ç—É–ø—ã
- INDENT/DEDENT —Ç–æ–∫–µ–Ω—ã (zero-width)
- NEWLINE —Ç–æ–∫–µ–Ω—ã
- EOF –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ü—Ä–æ–ø—É—Å–∫ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫

### 2. ‚úÖ External Scanner (`src/scanner.c`)

–ù–∞–ø–∏—Å–∞–Ω –Ω–∞ C –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç—Å—Ç—É–ø–æ–≤:
- –°—Ç–µ–∫ —É—Ä–æ–≤–Ω–µ–π –æ—Ç—Å—Ç—É–ø–æ–≤
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ EOF –∫–∞–∫ dedent –¥–æ —É—Ä–æ–≤–Ω—è 0
- Zero-width —Ç–æ–∫–µ–Ω—ã INDENT/DEDENT

### 3. ‚úÖ 11 —Ç–∏–ø–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤

–í—Å–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ:

| # | –¢–æ–∫–µ–Ω | –ü—Ä–∏–º–µ—Ä | –¶–≤–µ—Ç |
|---|-------|--------|------|
| 1 | `component_name` | `$mol_view` | –°–∏–Ω–∏–π |
| 2 | `binding_operator` | `<=`, `<=>`, `=>` | –§–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| 3 | `comment_marker` | `-` | –°–µ—Ä—ã–π |
| 4 | `list_marker` | `/` | –ñ–µ–ª—Ç—ã–π |
| 5 | `dict_marker` | `*`, `^` | –ñ–µ–ª—Ç—ã–π |
| 6 | `localization_marker` | `@` | –§–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| 7 | `string_literal` | `\text` | –ó–µ–ª–µ–Ω—ã–π |
| 8 | `number` | `42`, `3.14` | –û—Ä–∞–Ω–∂–µ–≤—ã–π |
| 9 | `boolean` | `true`, `false` | –û—Ä–∞–Ω–∂–µ–≤—ã–π |
| 10 | `null` | `null` | –û—Ä–∞–Ω–∂–µ–≤—ã–π |
| 11 | `identifier` | `name`, `prop?` | –ë–µ–ª—ã–π |

### 4. ‚úÖ Query —Ñ–∞–π–ª—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤

–°–æ–∑–¥–∞–Ω—ã 8 query —Ñ–∞–π–ª–æ–≤ –≤ `queries/`:

1. **highlights.scm** - –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞
   - –í—Å–µ 11 —Ç–∏–ø–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤
   - –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ (?, !, *)

2. **folds.scm** - –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–¥–∞
   - –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤ `children`

3. **indents.scm** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—Å—Ç—É–ø—ã
   - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ—Ç—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ `children`
   - –£–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ `_dedent`

4. **textobjects.scm** - Vim text objects
   - `@class.outer` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   - `@parameter.inner` - —Ü–µ–ø–æ—á–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤
   - `@block.outer` - –±–ª–æ–∫–∏ children

5. **locals.scm** - –ê–Ω–∞–ª–∏–∑ –æ–±–ª–∞—Å—Ç–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–≤–æ–π—Å—Ç–≤–∞

6. **tags.scm** - –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–∏–º–≤–æ–ª–∞–º
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (class)
   - –°–≤–æ–π—Å—Ç–≤–∞ (property)
   - –≠–∫–∑–µ–º–ø–ª—è—Ä—ã (instance)

7. **references.scm** - –ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
   - –°—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   - –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–≤–æ–π—Å—Ç–≤–∞
   - –°—Å—ã–ª–∫–∏ –Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã

8. **injections.scm** - –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —è–∑—ã–∫–∏
   - –ó–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

### 5. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω–æ 7 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:

1. **README.md** - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
2. **GRAMMAR.md** - –î–µ—Ç–∞–ª–∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏
3. **STRUCTURE.md** - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä —Å mol_tree2
4. **HIGHLIGHTS.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–æ–¥—Å–≤–µ—Ç–∫–µ
5. **QUERIES.md** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ query —Ñ–∞–π–ª–∞–º
6. **FINAL_SUMMARY.md** - –ò—Ç–æ–≥–æ–≤—ã–π summary
7. **COMPLETE.md** - –≠—Ç–æ—Ç —Ñ–∞–π–ª

### 6. ‚úÖ –¢–µ—Å—Ç—ã

–°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã:

- `test_simple.view.tree` - –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä
- `test_complex.view.tree` - –°–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `test_all_tokens.view.tree` - –í—Å–µ —Ç–∏–ø—ã —Ç–æ–∫–µ–Ω–æ–≤
- `test.js` - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å mol_tree2
- `verify_structure.js` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ! ‚úÖ**

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ü—Ä–∏–º–µ—Ä:
```
$hyoo_survey_app $mol_book2_catalog
	param \meet
```

### mol_tree2:
```json
{
  "type": "$hyoo_survey_app",
  "kids": [{
    "type": "$mol_book2_catalog",
    "kids": [{
      "type": "param",
      "kids": [{
        "type": "meet"
      }]
    }]
  }]
}
```

### tree-sitter:
```
token_chain
  component_name: "$hyoo_survey_app"
  token_chain
    component_name: "$mol_book2_catalog"
children
  line
    token_chain
      identifier: "param"
      token_chain
        string_literal: "\meet"
```

‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑–æ–º–æ—Ä—Ñ–Ω—ã!** (–æ–¥–∏–Ω–∞–∫–æ–≤–∞—è —Ñ–æ—Ä–º–∞, —Ä–∞–∑–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
bog/lsp/view.tree/tree-sitter-viewtree/
‚îú‚îÄ‚îÄ grammar.js                      # ‚úÖ –ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ —Å token_chain
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ scanner.c                   # ‚úÖ External scanner –Ω–∞ C
‚îú‚îÄ‚îÄ queries/
‚îÇ   ‚îú‚îÄ‚îÄ highlights.scm              # ‚úÖ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ folds.scm                   # ‚úÖ –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ indents.scm                 # ‚úÖ –ê–≤—Ç–æ–æ—Ç—Å—Ç—É–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ textobjects.scm             # ‚úÖ Vim text objects
‚îÇ   ‚îú‚îÄ‚îÄ locals.scm                  # ‚úÖ –û–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ tags.scm                    # ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ references.scm              # ‚úÖ –ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ injections.scm              # ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —è–∑—ã–∫–∏
‚îú‚îÄ‚îÄ test_simple.view.tree           # ‚úÖ –¢–µ—Å—Ç: –±–∞–∑–æ–≤—ã–π
‚îú‚îÄ‚îÄ test_complex.view.tree          # ‚úÖ –¢–µ—Å—Ç: —Å–ª–æ–∂–Ω—ã–π
‚îú‚îÄ‚îÄ test_all_tokens.view.tree       # ‚úÖ –¢–µ—Å—Ç: –≤—Å–µ —Ç–æ–∫–µ–Ω—ã
‚îú‚îÄ‚îÄ test.js                         # ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å mol_tree2
‚îú‚îÄ‚îÄ verify_structure.js             # ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ README.md                       # ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ GRAMMAR.md                      # ‚úÖ –î–µ—Ç–∞–ª–∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏
‚îú‚îÄ‚îÄ STRUCTURE.md                    # ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä
‚îú‚îÄ‚îÄ HIGHLIGHTS.md                   # ‚úÖ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–æ–¥—Å–≤–µ—Ç–∫–µ
‚îú‚îÄ‚îÄ QUERIES.md                      # ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è query
‚îú‚îÄ‚îÄ FINAL_SUMMARY.md                # ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π summary
‚îî‚îÄ‚îÄ COMPLETE.md                     # ‚úÖ –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞
```bash
npm run gen
```

### –ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞
```bash
tree-sitter parse example.view.tree
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏
```bash
tree-sitter query queries/highlights.scm example.view.tree
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å mol_tree2
```bash
npm run js
```

---

## üé® –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞–º–∏

### ‚úÖ Neovim (nvim-treesitter)
```lua
require'nvim-treesitter.configs'.setup {
  highlight = { enable = true },
  fold = { enable = true },
  indent = { enable = true },
}
```

### ‚úÖ Helix
–†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ `languages.toml`

### ‚úÖ Zed
–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ tree-sitter

### ‚úÖ VSCode
–ß–µ—Ä–µ–∑ tree-sitter —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏:** ~90
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ scanner:** ~135
- **Query —Ñ–∞–π–ª–æ–≤:** 8
- **–î–æ–∫—É–º–µ–Ω—Ç–æ–≤:** 7
- **–¢–µ—Å—Ç–æ–≤:** 3
- **–¢–∏–ø–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤:** 11
- **–í—Ä–µ–º–µ–Ω–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** ~4 —á–∞—Å–∞

---

## üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

‚úÖ –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ mol_tree2  
‚úÖ –í—Å–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è  
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏  
‚úÖ –ì–æ—Ç–æ–≤—ã–µ query —Ñ–∞–π–ª—ã –¥–ª—è –≤—Å–µ—Ö —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤  
‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  
‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç  

---

## ‚ú® –ò—Ç–æ–≥

**–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é –ø–æ–¥—Å–≤–µ—Ç–∫—É
- ‚úÖ –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—Å—Ç—É–ø—ã
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—é –ø–æ —Å–∏–º–≤–æ–ª–∞–º
- ‚úÖ –ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- ‚úÖ Vim text objects
- ‚úÖ LSP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é

**–°—Ç–∞—Ç—É—Å: COMPLETE ‚úÖ**
